-- Roblox 客户端脚本执行器
-- 蓝色霓虹风格 UI

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- 创建主界面
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NeonExecutor"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

if gethui then
    ScreenGui.Parent = gethui()
elseif syn and syn.protect_gui then
    syn.protect_gui(ScreenGui)
    ScreenGui.Parent = game.CoreGui
else
    ScreenGui.Parent = game.CoreGui
end

-- 颜色配置（蓝色霓虹主题）
local colors = {
    primary = Color3.fromRGB(0, 170, 255),
    secondary = Color3.fromRGB(0, 100, 200),
    accent = Color3.fromRGB(0, 255, 255),
    dark = Color3.fromRGB(10, 20, 40),
    darker = Color3.fromRGB(5, 10, 25),
    text = Color3.fromRGB(220, 240, 255),
    error = Color3.fromRGB(255, 50, 100),
    success = Color3.fromRGB(0, 255, 150)
}

-- 创建主窗口
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 500, 0, 400)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
mainFrame.BackgroundColor3 = colors.dark
mainFrame.BackgroundTransparency = 0.15
mainFrame.BorderSizePixel = 0
mainFrame.Parent = ScreenGui

-- 霓虹边框效果
local borderGlow = Instance.new("UIStroke")
borderGlow.Name = "BorderGlow"
borderGlow.Color = colors.primary
borderGlow.Thickness = 2
borderGlow.Transparency = 0.3
borderGlow.Parent = mainFrame

local innerGlow = Instance.new("Frame")
innerGlow.Name = "InnerGlow"
innerGlow.Size = UDim2.new(1, 0, 1, 0)
innerGlow.BackgroundTransparency = 1
innerGlow.BorderSizePixel = 0
innerGlow.Parent = mainFrame

local innerStroke = Instance.new("UIStroke")
innerStroke.Color = colors.accent
innerStroke.Thickness = 1
innerStroke.Transparency = 0.7
innerStroke.Parent = innerGlow

-- 标题栏
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = colors.darker
titleBar.BackgroundTransparency = 0.2
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleGlow = Instance.new("UIStroke")
titleGlow.Color = colors.primary
titleGlow.Thickness = 1
titleGlow.Transparency = 0.5
titleGlow.Parent = titleBar

local titleText = Instance.new("TextLabel")
titleText.Name = "TitleText"
titleText.Size = UDim2.new(0, 200, 1, 0)
titleText.Position = UDim2.new(0, 10, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "NEON EXECUTOR v2.0"
titleText.TextColor3 = colors.text
titleText.Font = Enum.Font.GothamBold
titleText.TextSize = 16
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Parent = titleBar

-- 控制按钮
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -30, 0, 0)
closeButton.BackgroundColor3 = colors.dark
closeButton.BackgroundTransparency = 0.5
closeButton.Text = "×"
closeButton.TextColor3 = colors.text
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 20
closeButton.Parent = titleBar

local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "MinimizeButton"
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -60, 0, 0)
minimizeButton.BackgroundColor3 = colors.dark
minimizeButton.BackgroundTransparency = 0.5
minimizeButton.Text = "○"
minimizeButton.TextColor3 = colors.text
minimizeButton.Font = Enum.Font.GothamBold
minimizeButton.TextSize = 16
minimizeButton.Parent = titleBar

-- 脚本输入区域
local scriptInput = Instance.new("ScrollingFrame")
scriptInput.Name = "ScriptInput"
scriptInput.Size = UDim2.new(0.98, 0, 0.5, -40)
scriptInput.Position = UDim2.new(0.01, 0, 0, 40)
scriptInput.BackgroundColor3 = colors.darker
scriptInput.BackgroundTransparency = 0.3
scriptInput.BorderSizePixel = 0
scriptInput.ScrollBarThickness = 8
scriptInput.ScrollBarImageColor3 = colors.primary
scriptInput.Parent = mainFrame

local inputBox = Instance.new("TextBox")
inputBox.Name = "InputBox"
inputBox.Size = UDim2.new(1, -10, 1, -10)
inputBox.Position = UDim2.new(0, 5, 0, 5)
inputBox.BackgroundTransparency = 1
inputBox.Text = "-- 在此处粘贴脚本\n-- 使用 loadstring 格式"
inputBox.TextColor3 = colors.text
inputBox.Font = Enum.Font.Code
inputBox.TextSize = 14
inputBox.TextXAlignment = Enum.TextXAlignment.Left
inputBox.TextYAlignment = Enum.TextYAlignment.Top
inputBox.TextWrapped = true
inputBox.ClearTextOnFocus = false
inputBox.MultiLine = true
inputBox.Parent = scriptInput

-- 输出区域
local outputFrame = Instance.new("ScrollingFrame")
outputFrame.Name = "OutputFrame"
outputFrame.Size = UDim2.new(0.98, 0, 0.35, -10)
outputFrame.Position = UDim2.new(0.01, 0, 0.52, 0)
outputFrame.BackgroundColor3 = colors.darker
outputFrame.BackgroundTransparency = 0.4
outputFrame.BorderSizePixel = 0
outputFrame.ScrollBarThickness = 8
outputFrame.ScrollBarImageColor3 = colors.accent
outputFrame.Parent = mainFrame

local outputText = Instance.new("TextLabel")
outputText.Name = "OutputText"
outputText.Size = UDim2.new(1, -10, 1, -10)
outputText.Position = UDim2.new(0, 5, 0, 5)
outputText.BackgroundTransparency = 1
outputText.Text = ">> 输出区域"
outputText.TextColor3 = colors.text
outputText.Font = Enum.Font.Code
outputText.TextSize = 12
outputText.TextXAlignment = Enum.TextXAlignment.Left
outputText.TextYAlignment = Enum.TextYAlignment.Top
outputText.TextWrapped = true
outputText.Parent = outputFrame

-- 按钮区域
local buttonFrame = Instance.new("Frame")
buttonFrame.Name = "ButtonFrame"
buttonFrame.Size = UDim2.new(0.98, 0, 0, 40)
buttonFrame.Position = UDim2.new(0.01, 0, 0.88, 0)
buttonFrame.BackgroundTransparency = 1
buttonFrame.Parent = mainFrame

-- 执行按钮
local executeButton = Instance.new("TextButton")
executeButton.Name = "ExecuteButton"
executeButton.Size = UDim2.new(0.3, 0, 1, 0)
executeButton.BackgroundColor3 = colors.primary
executeButton.BackgroundTransparency = 0.3
executeButton.Text = "执行脚本"
executeButton.TextColor3 = colors.text
executeButton.Font = Enum.Font.GothamBold
executeButton.TextSize = 14
executeButton.Parent = buttonFrame

-- 清除按钮
local clearButton = Instance.new("TextButton")
clearButton.Name = "ClearButton"
clearButton.Size = UDim2.new(0.3, 0, 1, 0)
clearButton.Position = UDim2.new(0.35, 0, 0, 0)
clearButton.BackgroundColor3 = colors.secondary
clearButton.BackgroundTransparency = 0.3
clearButton.Text = "清除"
clearButton.TextColor3 = colors.text
clearButton.Font = Enum.Font.GothamBold
clearButton.TextSize = 14
clearButton.Parent = buttonFrame

-- 注入按钮
local injectButton = Instance.new("TextButton")
injectButton.Name = "InjectButton"
injectButton.Size = UDim2.new(0.3, 0, 1, 0)
injectButton.Position = UDim2.new(0.7, 0, 0, 0)
injectButton.BackgroundColor3 = colors.accent
injectButton.BackgroundTransparency = 0.3
clearButton.TextColor3 = colors.text
clearButton.Font = Enum.Font.GothamBold
clearButton.TextSize = 14
clearButton.Parent = buttonFrame

-- 创建UI球（最小化状态）
local uiBall = Instance.new("ImageButton")
uiBall.Name = "UIBall"
uiBall.Size = UDim2.new(0, 50, 0, 50)
uiBall.Position = UDim2.new(1, -60, 1, -60)
uiBall.BackgroundColor3 = colors.dark
uiBall.BackgroundTransparency = 0.2
uiBall.Image = "rbxassetid://78752306566484"
uiBall.ScaleType = Enum.ScaleType.Fit
uiBall.Visible = false
uiBall.Parent = ScreenGui

local ballGlow = Instance.new("UIStroke")
ballGlow.Color = colors.accent
ballGlow.Thickness = 2
ballGlow.Transparency = 0.5
ballGlow.Parent = uiBall

-- 霓虹脉冲效果
local pulseEffect = Instance.new("UIGradient")
pulseEffect.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, colors.primary),
    ColorSequenceKeypoint.new(0.5, colors.accent),
    ColorSequenceKeypoint.new(1, colors.primary)
})
pulseEffect.Rotation = 45
pulseEffect.Enabled = false
pulseEffect.Parent = mainFrame

-- 动画变量
local isMinimized = false
local isDragging = false
local dragStartPos, frameStartPos

-- 更新输出函数
local function updateOutput(message, color)
    outputText.TextColor3 = color or colors.text
    outputText.Text = ">> " .. tostring(message) .. "\n" .. outputText.Text
end

-- 执行脚本函数
local function executeScript()
    local scriptCode = inputBox.Text
    
    if scriptCode and scriptCode ~= "" then
        updateOutput("正在执行脚本...", colors.accent)
        
        local success, result = pcall(function()
            local fn, err = loadstring(scriptCode)
            if fn then
                return fn()
            else
                error(err)
            end
        end)
        
        if success then
            updateOutput("脚本执行成功!", colors.success)
        else
            updateOutput("执行错误: " .. tostring(result), colors.error)
        end
    else
        updateOutput("请输入脚本代码", colors.error)
    end
end

-- 清除输出函数
local function clearOutput()
    outputText.Text = ">> 输出区域"
end

-- 注入函数
local function injectScript()
    updateOutput("注入功能已激活", colors.accent)
    -- 这里可以添加自定义注入逻辑
end

-- UI拖动功能
titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = true
        dragStartPos = input.Position
        frameStartPos = mainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if isDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStartPos
        mainFrame.Position = UDim2.new(
            frameStartPos.X.Scale,
            frameStartPos.X.Offset + delta.X,
            frameStartPos.Y.Scale,
            frameStartPos.Y.Offset + delta.Y
        )
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = false
    end
end)

-- 最小化/恢复动画
local function toggleMinimize()
    if isMinimized then
        -- 恢复UI
        local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
        
        local tween1 = TweenService:Create(mainFrame, tweenInfo, {
            Size = UDim2.new(0, 500, 0, 400),
            Position = UDim2.new(0.5, -250, 0.5, -200),
            BackgroundTransparency = 0.15
        })
        
        local tween2 = TweenService:Create(uiBall, tweenInfo, {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        })
        
        tween1:Play()
        tween2:Play()
        
        tween2.Completed:Connect(function()
            uiBall.Visible = false
            mainFrame.Visible = true
        end)
        
        pulseEffect.Enabled = true
        isMinimized = false
    else
        -- 最小化成球
        local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.In)
        
        local targetPos = UDim2.new(1, -60, 1, -60)
        local currentPos = mainFrame.Position
        
        local tween1 = TweenService:Create(mainFrame, tweenInfo, {
            Size = UDim2.new(0, 0, 0, 0),
            Position = targetPos,
            BackgroundTransparency = 1
        })
        
        uiBall.Visible = true
        uiBall.Size = UDim2.new(0, 0, 0, 0)
        uiBall.Position = targetPos
        uiBall.BackgroundTransparency = 1
        
        local tween2 = TweenService:Create(uiBall, tweenInfo, {
            Size = UDim2.new(0, 50, 0, 50),
            BackgroundTransparency = 0.2
        })
        
        tween1:Play()
        tween2:Play()
        
        tween1.Completed:Connect(function()
            mainFrame.Visible = false
        end)
        
        pulseEffect.Enabled = false
        isMinimized = true
    end
end

-- 按钮事件
executeButton.MouseButton1Click:Connect(executeButton, executeScript)
clearButton.MouseButton1Click:Connect(clearButton, clearOutput)
injectButton.MouseButton1Click:Connect(injectButton, injectScript)
minimizeButton.MouseButton1Click:Connect(minimizeButton, toggleMinimize)
uiBall.MouseButton1Click:Connect(uiBall, toggleMinimize)

closeButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- 按钮悬停效果
local function setupButtonHover(button, baseColor, hoverColor)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = hoverColor,
            BackgroundTransparency = 0.1
        }):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = baseColor,
            BackgroundTransparency = 0.3
        }):Play()
    end)
end

setupButtonHover(executeButton, colors.primary, colors.accent)
setupButtonHover(clearButton, colors.secondary, colors.primary)
setupButtonHover(injectButton, colors.accent, colors.success)
setupButtonHover(minimizeButton, colors.dark, colors.primary)
setupButtonHover(closeButton, colors.dark, colors.error)

-- 脉冲动画
local pulseConnection
local function startPulseAnimation()
    if pulseConnection then
        pulseConnection:Disconnect()
    end
    
    pulseConnection = RunService.Heartbeat:Connect(function(delta)
        local time = tick()
        local pulse = (math.sin(time * 2) + 1) / 2
        
        borderGlow.Transparency = 0.3 + pulse * 0.2
        titleGlow.Transparency = 0.5 + pulse * 0.2
        
        pulseEffect.Offset = Vector2.new(pulse * 0.5, pulse * 0.5)
    end)
end

startPulseAnimation()

-- 初始化完成
updateOutput("霓虹脚本执行器已加载!", colors.accent)
updateOutput("使用 loadstring 格式执行脚本", colors.text)

-- 添加一些视觉效果
local particles = Instance.new("Frame")
particles.Name = "Particles"
particles.Size = UDim2.new(1, 0, 1, 0)
particles.BackgroundTransparency = 1
particles.Parent = mainFrame

-- 创建一些装饰性粒子
for i = 1, 5 do
    local particle = Instance.new("Frame")
    particle.Size = UDim2.new(0, 2, 0, 2)
    particle.BackgroundColor3 = colors.accent
    particle.BackgroundTransparency = 0.7
    particle.BorderSizePixel = 0
    particle.Parent = particles
    
    spawn(function()
        while particle and particle.Parent do
            local x = math.random(0, 100) / 100
            local y = math.random(0, 100) / 100
            local tween = TweenService:Create(particle, TweenInfo.new(2), {
                Position = UDim2.new(x, 0, y, 0),
                BackgroundTransparency = math.random(5, 9) / 10
            })
            tween:Play()
            wait(2)
        end
    end)
end
